{"version":3,"sources":["../src/errorHandle.js"],"names":["module","exports","app","option","constant","resolve","msg","service","$q","errors","AlertService","LoginService","handle","data","defer","defaultMessage","message","idsIntercepted","jumpLogin","resultCode","length","i","code","callback","config","successCode","alertMessage","alert","title","content","reject","promise"],"mappings":";;AAAAA,OAAOC,OAAP,GAAiB,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AACpCD,QAAIE,QAAJ,CAAa,QAAb,EAAuB;AACnB,aAAK,iBADc;AAEnB,aAAK;AACD;AACAC,qBAAS,IAFR;AAGDC,iBAAK;AAHJ,SAFc;AAOnB,aAAK;AAPc,KAAvB,EAQGC,OARH,CAQW,aARX,EAQ0B,CAAC,IAAD,EAAO,QAAP,EAAiB,cAAjB,EAAiC,cAAjC,EACtB,UAAUC,EAAV,EAAcC,MAAd,EAAsBC,YAAtB,EAAoCC,YAApC,EAAkD;AAC9C;;AACA,eAAO;AACHC,oBAAQ,gBAAUC,IAAV,EAAgB;AACpB,oBAAIC,QAAQN,GAAGM,KAAH,EAAZ;AAAA,oBACIC,iBAAiB,iBADrB;AAAA,oBAEIC,UAAUH,KAAKG,OAAL,IAAgBD,cAF9B;;AAIA,oBAAIF,KAAKI,cAAT,EAAyB;AACrBN,iCAAaO,SAAb,CAAuBL,IAAvB;AACA;AACH;;AAED,oBAAIM,aAAahB,OAAOgB,UAAxB;AACA,oBAAIA,cAAcA,WAAWC,MAA7B,EAAqC;AACjC,yBAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,WAAWC,MAA/B,EAAuCC,GAAvC,EAA4C;AACxC,4BAAIR,KAAKM,UAAL,KAAoBA,WAAWE,CAAX,EAAcC,IAAtC,EAA4C;AACxCH,uCAAWE,CAAX,EAAcE,QAAd,IAA0BJ,WAAWE,CAAX,EAAcE,QAAd,CAAuBT,KAAvB,EAA8BD,IAA9B,CAA1B;AACH;AACJ;AACJ;;AAED,oBAAIA,KAAKM,UAAL,KAAoBhB,OAAOqB,MAAP,CAAcC,WAAtC,EAAmD;AAC/CX,0BAAMT,OAAN,CAAcQ,KAAKA,IAAnB;AACH,iBAFD,MAEO,IAAIV,OAAOqB,MAAP,CAAcE,YAAlB,EAAgC;AACnChB,iCAAaiB,KAAb,CAAmB;AACfC,+BAAO,MADQ;AAEfC,iCAASb;AAFM,qBAAnB;AAIAF,0BAAMgB,MAAN,CAAajB,IAAb;AACH;AACD,uBAAOC,MAAMiB,OAAb;AACH;AA9BE,SAAP;AAgCH,KAnCqB,CAR1B;AA6CH,CA9CD","file":"errorHandle.js","sourcesContent":["module.exports = function (app, option) {\r\n    app.constant('errors', {\r\n        500: '系统出了点小问题，请稍后重试！',\r\n        401: {\r\n            //需到controller中单独处理的错误\r\n            resolve: true,\r\n            msg: '（未授权） 请求要求身份验证'\r\n        },\r\n        404: '（未找到） 服务器找不到请求的网页'\r\n    }).service('ErrorHandle', ['$q', 'errors', 'AlertService', 'LoginService',\r\n        function ($q, errors, AlertService, LoginService) {\r\n            'use strict';\r\n            return {\r\n                handle: function (data) {\r\n                    var defer = $q.defer(),\r\n                        defaultMessage = '系统出了点小问题，请稍后重试！',\r\n                        message = data.message || defaultMessage;\r\n\r\n                    if (data.idsIntercepted) {\r\n                        LoginService.jumpLogin(data);\r\n                        return\r\n                    }\r\n\r\n                    var resultCode = option.resultCode\r\n                    if (resultCode && resultCode.length) {\r\n                        for (var i = 0; i < resultCode.length; i++) {\r\n                            if (data.resultCode === resultCode[i].code) {\r\n                                resultCode[i].callback && resultCode[i].callback(defer, data)\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    if (data.resultCode === option.config.successCode) {\r\n                        defer.resolve(data.data);\r\n                    } else if (option.config.alertMessage) {\r\n                        AlertService.alert({\r\n                            title: '提示信息',\r\n                            content: message\r\n                        });\r\n                        defer.reject(data);\r\n                    }\r\n                    return defer.promise;\r\n                }\r\n            };\r\n        }\r\n    ]);\r\n}"]}